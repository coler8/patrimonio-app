<div class="space-y-6">
  <!-- Botones de meses -->
  <div class="flex flex-wrap gap-2 mb-6">
    @for ( mes of meses; track mes) {
    <button
      class="px-3 py-1 rounded-lg border text-sm font-medium cursor-pointer"
      [ngClass]="{
        'bg-blue-600 text-white border-blue-600': mes === mesSeleccionado,
        'bg-white text-gray-700 border-gray-300 hover:bg-gray-100': mes !== mesSeleccionado
      }"
      (click)="cargarResumenMes(mes)"
    >
      {{ mes | titlecase }}
    </button>
    }
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- Liquidez -->
    <div class="bg-white rounded-xl card-shadow p-5 border-l-4 border-blue-500">
      <h3 class="text-md font-bold text-gray-800 mb-3">
        ðŸ’° Liquidez/Fondo emergencia ({{
          (distribucionLocal.liquidez / totalMesSeleccionado()) * 100 | number : '1.1-1'
        }}%) âžœ {{ distribucionLocal.liquidez | currency }}
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-700 mb-2">Sabadell</label>
          <input
            type="number"
            [(ngModel)]="distribucionLocal.liquidez"
            (ngModelChange)="onDistribucionChange()"
            class="input-field pr-8"
          />
          <span class="absolute right-2 top-1/2 text-gray-500">â‚¬</span>
        </div>
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-700 mb-2">Zen</label>
          <input
            type="number"
            [(ngModel)]="distribucionLocal.zen"
            (ngModelChange)="onDistribucionChange()"
            class="input-field pr-8"
          />
          <span class="absolute right-2 top-1/2 text-gray-500">â‚¬</span>
        </div>
      </div>
    </div>

    <!-- Cuentas Remuneradas -->
    <div class="bg-white rounded-xl card-shadow p-5 border-l-4 border-purple-500">
      <h3 class="text-md font-bold text-gray-800 mb-3">
        ðŸ’³ Cuentas Remuneradas ({{
          (distribucionLocal.cuentasRemuneradas / totalMesSeleccionado()) * 100 | number : '1.1-1'
        }}%) âžœ {{ distribucionLocal.cuentasRemuneradas | currency }}
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Trade Republic</label>
          <input
            type="number"
            [(ngModel)]="distribucionLocal.tradeRepublic"
            (ngModelChange)="onDistribucionChange()"
            class="input-field"
          />
          <span class="absolute right-2 top-1/2 text-gray-500">â‚¬</span>
        </div>

        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">MyInvestor</label>
          <input
            type="number"
            [(ngModel)]="distribucionLocal.myInvestor"
            (ngModelChange)="onDistribucionChange()"
            class="input-field"
          />
          <span class="absolute right-2 top-1/2 text-gray-500">â‚¬</span>
        </div>
      </div>
    </div>

    <!-- Fondos Indexados -->
    <div class="bg-white rounded-xl card-shadow p-5 border-l-4 border-indigo-500">
      <h3 class="text-md font-bold text-gray-800 mb-3">
        ðŸ“ˆ Renta Variable (Acciones/Fondos/ETFs) ({{
          (distribucionLocal.fondosIndexados / totalMesSeleccionado()) * 100 | number : '1.1-1'
        }}%) âžœ {{ distribucionLocal.fondosIndexados | currency }}
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            ðŸ“Š Fondos Indexados (MSCI WORLD y Emerging Markets)
          </label>
          <input
            type="number"
            [(ngModel)]="distribucionLocal.fondosIndexados"
            (ngModelChange)="onDistribucionChange()"
            class="input-field"
          />
          <span class="absolute right-2 top-1/2 text-gray-500">â‚¬</span>
        </div>
      </div>
    </div>

    <!-- Criptos -->
    <div class="bg-white rounded-xl card-shadow p-5 border-l-4 border-pink-500">
      <h3 class="text-md font-bold text-gray-800 mb-3">
        ðŸ’³ Criptos ({{ patrimonioService.totalPorcentajeCryptos() | number : '1.1-1' }}%) âžœ
        {{ patrimonioService.sumarCryptos(distribucionLocal.cryptos) | currency }}
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        @for (wallet of cryptoWallets; track wallet) {
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            {{ wallet | titlecase }}
          </label>

          <input
            class="input-field"
            type="number"
            [(ngModel)]="distribucionLocal.cryptos[wallet]"
            (ngModelChange)="onDistribucionChange()"
          />
          <span class="absolute right-2 top-1/2 text-gray-500">â‚¬</span>
        </div>
        }
      </div>
    </div>
  </div>

  <div class="bg-white rounded-xl card-shadow p-5 border-l-4 border-pink-500">
    <h2 class="text-md font-bold text-gray-800 mb-3">
      ðŸ’³ Total: {{ totalMesSeleccionado() | currency }}
    </h2>
  </div>
  <div class="mt-8 lg:mt-0">
    <button (click)="guardarMes()" class="w-full btn-primary">Guardar Mes Actual</button>
  </div>

  <!-- GrÃ¡fico -->
  <div class="bg-slate-800 rounded-lg card-shadow p-6">
    <h3 class="text-xl font-bold mb-4 text-gray-600">DistribuciÃ³n Actual</h3>
    <div class="max-h-full">
      <canvas
        baseChart
        [datasets]="[
          { data: distribucionValues(), backgroundColor: distribucionColors, borderWidth: 2 }
        ]"
        [labels]="distribucionLabels"
        [options]="chartDistribucionOptions"
        [plugins]="pluginsDistribucionOptions"
        type="doughnut"
      ></canvas>
    </div>
  </div>

  <app-historial-detallado [historial]="historialOrdenado"></app-historial-detallado>
</div>
